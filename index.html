<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TEST KOSA KATA</title>

<style>
@keyframes fadeIn{from{opacity:0;transform:translateY(20px)}to{opacity:1}}
html,body{margin:0;height:100%;font-family:'Segoe UI',Arial}
body{
background:url('https://raw.githubusercontent.com/airnetcso/eps/main/image/bg1.jpg') center/cover no-repeat fixed;
display:flex;justify-content:center;align-items:center;color:#fff
}
body::before{content:'';position:absolute;inset:0;background:rgba(0,0,0,.4)}
.container{
position:relative;z-index:2;width:90%;max-width:420px;
background:rgba(255,255,255,.15);backdrop-filter:blur(14px);
padding:35px;border-radius:24px;
box-shadow:0 20px 40px rgba(0,0,0,.4);
animation:fadeIn .6s ease
}
h1{text-align:center;margin-bottom:25px}
input,button{
width:100%;padding:15px;margin-top:14px;
font-size:17px;border-radius:12px;border:none
}
input{background:rgba(255,255,255,.25);color:white}
input::placeholder{color:#eee}
button{
background:linear-gradient(90deg,#10b981,#059669);
color:white;font-weight:bold;cursor:pointer
}
button:hover{transform:translateY(-2px)}
.hidden{display:none}
#error{margin-top:14px;color:#ffb4b4;text-align:center}
#timer{text-align:center;font-size:26px;margin:15px 0}
.progress{height:10px;background:#ccc;border-radius:5px}
.progress-bar{height:100%;width:0;background:#10b981;border-radius:5px}
.question strong{display:block;font-size:42px;text-align:center;margin:30px 0}
.wrong-list{margin-top:20px;background:#fff3cd;color:#92400e;padding:15px;border-radius:10px}
</style>
</head>

<body>

<!-- ================= LOGIN PAGE ================= -->
<div class="container" id="loginPage">
<h1>LOGIN</h1>
<input id="username" placeholder="Username">
<input id="password" type="password" placeholder="Password">
<div id="error"></div>
<button onclick="login()">MASUK</button>
</div>

<!-- ================= PILIH KODE ================= -->
<div class="container hidden" id="kodePage">
<h1>PILIH KODE TEST</h1>
<input id="kodeSoal" placeholder="Masukkan Kode Test">
<button onclick="startTest()">MULAI TEST</button>
</div>

<!-- ================= QUIZ ================= -->
<div class="container hidden" id="quizPage">
<h1>TEST KOSA KATA</h1>
<div id="timer">30:00</div>
<div class="progress"><div class="progress-bar" id="progressBar"></div></div>

<div id="questionArea">
<div class="question"><strong id="currentWord"></strong></div>
<input id="answerInput" placeholder="Ketik jawaban">
<button onclick="submitAnswer()">SUBMIT</button>
</div>

<div id="resultArea" class="hidden">
<h2>HASIL TEST</h2>
<p id="scoreText"></p>
<div id="wrongWords" class="wrong-list hidden"></div>
<button onclick="location.reload()">SELESAI</button>
</div>
</div>

<script>
/* ================= AKUN ================= */
const adminAccount = { username:"admin", password:"admin123" };

const users = [
  { username:"user1", password:"12345" },
  { username:"hanarizka", password:"Nungkihana24!" },
  { username:"user3", password:"12345" },
  { username:"siswa01", password:"12345" },
  { username:"windi", password:"Windi2000" },
  { username:"rismaya97", password:"bahasakorea" },
  { username:"admin", password:"admin123"}
  { username:"sita77", password:"minyooki" },
  { username:"Aini185", password:"Doraemon" },
  { username:"Hangeulfei", password:"studykorea02" },
  { username:"Hamdan106", password:"Fukuo106"},
  { username:"user4", password:"12345" },
  { username:"user5", password:"12345" }
];

/* ================= KODE SOAL ================= */
const kodeMapping = {
  "H29976":"soal1.json",
  "R43213":"soal2.json",
  "Z21985":"soal3.json"
};

let questions=[],currentIndex=0,score=0,timeLeft=3000,timer;
let loginUser="",kodeAktif="",wrongList=[];

/* ================= LOGIN ================= */
function login(){
loginUser=document.getElementById("username").value.trim();
const pass=document.getElementById("password").value.trim();
const error=document.getElementById("error");
error.textContent="";

if(!loginUser||!pass){
error.textContent="Username dan password wajib!";
return;
}

/* ADMIN */
if(loginUser===adminAccount.username && pass===adminAccount.password){
window.location.href="admin.html";
return;
}

/* USER */
const validUser = users.find(u=>u.username===loginUser && u.password===pass);
if(!validUser){
error.textContent="Username atau password salah!";
return;
}

document.getElementById("loginPage").classList.add("hidden");
document.getElementById("kodePage").classList.remove("hidden");
}

/* ================= START TEST ================= */
function startTest(){
kodeAktif=document.getElementById("kodeSoal").value.trim().toUpperCase();
if(!kodeMapping[kodeAktif]){
alert("Kode test tidak valid!");
return;
}

fetch(kodeMapping[kodeAktif])
.then(r=>r.json())
.then(d=>{
questions=d.sort(()=>Math.random()-.5);
document.getElementById("kodePage").classList.add("hidden");
document.getElementById("quizPage").classList.remove("hidden");
startQuiz();
});
}

/* ================= QUIZ ================= */
function startQuiz(){
currentIndex=0;score=0;wrongList=[];timeLeft=1800;
updateTimer();
timer=setInterval(()=>{
timeLeft--;updateTimer();
if(timeLeft<=0) finishQuiz();
},1000);
nextQuestion();
}

function updateTimer(){
const m=String(Math.floor(timeLeft/60)).padStart(2,'0');
const s=String(timeLeft%60).padStart(2,'0');
document.getElementById("timer").textContent=`${m}:${s}`;
}

function nextQuestion(){
if(currentIndex>=questions.length) return finishQuiz();
document.getElementById("currentWord").textContent=questions[currentIndex].korea;
document.getElementById("answerInput").value="";
document.getElementById("answerInput").focus();
document.getElementById("progressBar").style.width=
((currentIndex/questions.length)*100)+"%";
}

function submitAnswer(){
const ans=document.getElementById("answerInput").value.trim().toLowerCase();
const q=questions[currentIndex];

if(ans!==q.indo.toLowerCase()){
wrongList.push(`${q.korea} â†’ ${q.indo}`);
}else{
score++;
}
currentIndex++;
nextQuestion();
}

/* ================= FINISH ================= */
function finishQuiz(){
clearInterval(timer);
document.getElementById("questionArea").classList.add("hidden");
document.getElementById("resultArea").classList.remove("hidden");

const percent=Math.round((score/questions.length)*100);
document.getElementById("scoreText").textContent=
`Skor ${score}/${questions.length} (${percent}%)`;

if(wrongList.length){
const w=document.getElementById("wrongWords");
w.classList.remove("hidden");
w.innerHTML="<strong>Jawaban salah:</strong><br>"+wrongList.join("<br>");
}

/* SIMPAN KE LOCALSTORAGE */
const data=JSON.parse(localStorage.getItem("testResults")||"[]");
data.push({
username:loginUser,
kode:kodeAktif,
score,
total:questions.length,
percent,
date:new Date().toLocaleString("id-ID")
});
localStorage.setItem("testResults",JSON.stringify(data));
}
</script>

</body>
</html>
